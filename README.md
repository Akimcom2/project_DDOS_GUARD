# Project_DDOS_GUARD
Техническое задание для компании DDOS-GUARD
Индивидуальное тестовое задание для DevOps-инженера

Цель: создание сценария развёртывания сервисов и систем

## Требования к ПО
Debian 12
MariaDB - 10.3 или новее
docker + docker-compose (или плагин docker compose)
grafana, prometheus - последние стабильные версии
prometheus-node-exporter, mysqld_exporter - версии, доступные в соответствии с выбранными ОС и ПО

## Описание задания
Задание предполагает развёртывание решения на двух системах
1. В первой системе должны быть развёрнуты prometheus-node-exporter, mariadb, mysqld_exporter + фаерволл (nftables). Развёртывание предполагается без использования контейнеризации.
2. В первой системе должен быть сконфигурирован фаерволл - закрыты все порты, кроме ssh, prometheus-node-exporter, mariadb, mysqld_exporter. Список открытых портов должен задаваться в виде переменных в ansible.
3. Во второй системе должны быть развёрнуты docker + docker compose, prometheus и grafana. Файлы конфигураций должны находиться на хосте и монтироваться в контейнеры в режиме ro.
4. В prometheus должен быть организован сбор метрик prometheus-node-exporter и mysqld_exporter
5. В grafana необходимо реализовать два dashboard:
	- общие метрики ОС (cpu, RAM, загруженность сетевых интерфейсов, заполненность диска);
	- метрики mariadb - количество соединений, количество запросов в общем, отдельно количество чтений (select), отдельно количество остальных операций записи (update, insert, delete).

## Ожидаемый результат
Проект должен состоять из
1. набора конфигураций для каждого из используемого ПО.
2. docker-compose.yml файла, разворачивающего контейнеры и монтирующего структуру каталогов с файлами конфигураций. Развёртывание должно происходить без дополнительных действий на хосте - все предварительные подготовки должны быть проведены посредством ansible.
3. json-моделей dashboard’ов, готовых для импорта в развёрнутое решение.

Проект должен быть загружен в git репозиторий (с публичным доступом) в виде ansible проекта, (включающего шаблоны и файлы, используемые в процессе). 
Также должно присутствовать описание проекта, позволяющее его использовать для развёртывания описанного решения.

# Решение
## Структура файлов и каталогов решения

```
project/
├── ansible/                # Конфигурационные файлы Ansible
│   ├── roles/              # Роли Ansible
│   │   ├── common/         # Общая роль для обеих систем
│   │   └── systemX/        # Роль для системы X
│   ├── playbooks/          # Playbook'и для каждой системы
│   │   ├── deploy_system_X.yml
│   │   └── deploy_system_Y.yml
|   |___
├── docker/                 # Docker Compose файл и структуры каталогов
│   ├── docker-compose.yml
│   └── volumes/            # Монтированные директории с конфигурациями
│       ├── prometheus/prometheus.yml
│       └── grafana/grafana.ini
├── dashboards/             # JSON модели dashboard'ов для Grafana
│   ├── os_metrics.json
│   └── mysql_metrics.json
└── README.md               # Описание проекта
```
## Проверка структуры
Проверка была выполнена на виртуальных хостах:
#### 89.104.66.160 - Docker/Prometheus/Grafana
#### 89.104.66.136 - Prometheus-node-exporter, mariadb, mysqld_exporter + фаерволл (nftables)
Проверить хосты можно под учеткой root,пароли:
>! As3He1mNUdYmEbjC
>! nh7NHvts9ir3z2Dy
Оставляю в открытом виде,хосты будут удалены 22.03.2025

## Сценарий работы с решением
1. Развернуть систему X:
	```
	ansible-playbook -i inventory.ini playbooks/deploy_system_X.yml
	```
2. Развернуть систему Y:
	```
	ansible-playbook -i inventory.ini playbooks/deploy_system_Y.yml
	```
3. Импортировать dashboards в Grafana:
	Открыть веб-интерфейс Grafana (http://systemY:3000) и войти под учетной записью администратора.
	Перейти в раздел Dashboards -> Manage, выбрать опцию Import и загрузить подготовленные JSON-файлы.
	
Таким образом, вы получите готовое решение для мониторинга вашей инфраструктуры с использованием Prometheus, Grafana и MariaDB.
